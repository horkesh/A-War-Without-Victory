# State matrix (AWWV) — feature slice status — v0.2

**Version:** v0.2 (post–Executive Roadmap Phases 1–6). Stable ordering: rows sorted by ID (A-*, D-*, M-*, S-*, U-*), then Feature name. Status values: Planned & Working | Planned but Not Working | Planned & Not Implemented | Unplanned but Implemented.

| ID | Feature | Canon refs | Code refs | Entrypoints | Artifacts | Tests/Gates | Status | Evidence | Blockers | MVP |
|----|---------|------------|-----------|-------------|-----------|-------------|--------|----------|----------|-----|
| A-STATE | GameState definition and validation | Engine_Invariants_v0_4_0 §13.1; Systems_Manual_v0_4_0 | game_state.ts, validateGameState.ts, schema.ts | N/A (state shape) | N/A | validateGameStateShape tests, serializeGameState denylist | Planned & Working | serializeGameState.ts rejects Map/Set and denylist keys; validateGameState tests pass | None | Y |
| A-TURN-PIPELINE | War-phase turn pipeline | Phase_Specifications_v0_4_0; Systems_Manual | src/sim/turn_pipeline.ts | sim_run.ts, sim_scenario.ts, scenario_runner.ts | runs/*/final_save.json | scenario_determinism_h1_1, run_baseline_regression | Planned & Working | runTurn imported by scenario_runner and CLIs; baseline regression exists | None | Y |
| A-TURN-PIPELINE-STATE | Phase 0 / state turn pipeline | Phase_0_Specification_v0_4_0; state/turn_pipeline.ts | src/state/turn_pipeline.ts | Used when meta.phase is Phase 0 | N/A | runOneTurn; phase0_referendum_held_war_start_e2e, phase0_v1_no_war | Planned & Working | runOneTurn + referendum/war-start e2e tests; warroom run_phase0_turn.ts | None | Y |
| D-BASELINE-REGRESSION | Golden baseline regression | DETERMINISM_TEST_MATRIX.md; CODE_CANON | run_baseline_regression.ts | npm run test:baselines | data/derived/scenario/baselines/manifest.json | scenario_golden_baselines_h2_3.test.ts | Planned & Working | Script compares SHA256; v0.2 baselines green | None | Y |
| D-DETERMINISM-SCAN | No Date.now/Math.random in core pipeline | DETERMINISM_TEST_MATRIX.md | determinism_static_scan_r1_5.test.ts | npm test | N/A | determinism_static_scan_r1_5.test.ts | Planned & Working | v0.2: scan passes; warroom UI excluded from scope | None | Y |
| D-SCENARIO-DETERMINISM | Same scenario twice → identical final_save | Engine Invariants §11; DETERMINISM_TEST_MATRIX | scenario_determinism_h1_1.test.ts | npm test | final_save.json | scenario_determinism_h1_1.test.ts | Planned & Working | Test runs two scenarios and compares serialized state | None | Y |
| M-MAP-BUILD | Map build pipeline | MAP_BUILD_SYSTEM.md; PIPELINE_ENTRYPOINTS | tools/map/build_map.ts; scripts/map/* | npm run map:build:new; map:derive:substrate; etc. | data/derived/*.geojson, polygon_fabric, viewers | map:check; validate_map_contracts | Planned & Working | v0.2: MAP_BUILD_SYSTEM aligned with entrypoints and data contracts | None | Y |
| M-SETTLEMENTS-INITIAL-MASTER | Settlements initial master (Turn 0 metadata) | Ledger Phase H7.0/H7.2 | build_settlements_initial_master.ts, political_control_init.ts | map:build:settlements-initial-master | settlements_initial_master.json, audit | map:build:ethnicity, map:build:municipal-control-status | Planned & Working | Ledger; v0.2 type-safe cast via unknown | None | Y |
| S-SCENARIO-RUNNER | Scenario harness (multi-turn) | PIPELINE_ENTRYPOINTS; CODE_CANON | scenario_runner.ts, scenario_loader.ts | run_scenario.ts, run_baseline_regression, sim_scenario CLI | runs/<run_id>/* | scenario_harness_smoke_h1_4, test:baselines | Planned & Working | Single canonical runScenario; used by tools and CLI | None | Y |
| S-SERIALIZATION | State serialize/deserialize | Engine_Invariants §13.1; serialize.ts | serializeGameState.ts, serialize.ts | All paths that save/load state | final_save.json, replay | Serializer rejects Map/Set; validateState round-trip tests | Planned & Working | Denylist in validateGameState; stable key ordering | None | Y |
| U-PHASE-G | Phase G dev UI (control/cost view) | V1_0_PACKAGING; ledger | dev_ui/phase_g.html, phase_g.ts | npm run dev:map | Read-only GameState view | Smoke tests | Planned & Working | Packaging doc; phase_g loads save JSON | None | Y |
| U-WARROOM-GUI | Warroom UI (MVP 1.0) | IMPLEMENTATION_PLAN_GUI_MVP; EXECUTIVE_ROADMAP; ledger | src/ui/warroom/* | npm run dev:warroom; warroom:build | Staged assets, clickable regions, settlement_edges | warroom:build succeeds | Planned & Working | v0.2: typecheck green; advance turn wired to Phase 0 pipeline | None | Y |
| U-WARROOM-TURN | Warroom Phase 0 turn advancement | EXECUTIVE_ROADMAP Phase 4; MVP_CHECKLIST | run_phase0_turn.ts, ClickableRegionManager | Calendar advance → runPhase0TurnAndAdvance | N/A | warroom:build | Planned & Working | Browser-safe runner; onGameStateChange; Phase I+ not wired | None | Y |

**Evidence policy:** Working = at least one gate or test reference; Planned = canon or roadmap ref. Blockers and MVP column inform mvp_backlog.md.

**docs/10_canon/FORAWWV.md may require an addendum** if code paths contradict canon (e.g. Phase 0 war start). Do NOT edit FORAWWV automatically.
